ì—¬ëŸ¬ê°œì¼ë•Œ if ì§„ì§œ í•„ìš”í•œì§€ ë‹¤ì‹œ ë³´ê¸°

êµ³ì´ ì•ˆì¨ë„ ë ìˆ˜ë„ ìˆìŒ



# ğŸš¢íƒ€ì´íƒ€ë‹‰ 

```
#210303
df<-read.csv("train.csv", na.strings="") #ê²°ì¸¡ NA
str(df)

View(df) #v ëŒ€ë¬¸ì

#ê¸°ìˆ í†µê³„ëŸ‰ í•¨ìˆ˜ê°€ í¬í•¨ëœ íŒ¨í‚¤ì§€
install.packages("psych")
library(psych)

#ê²°ì¸¡ë§µ í•¨ìˆ˜ê°€ í¬í•¨ëœ íŒ¨í‚¤ì§€
install.packages("Amelia")
library(Amelia)

missmap(df,col=c("red","grey")) #ë¯¸ì‹±ë°ì´í„° ìƒ‰ê¹”
```

ê²°ì¸¡ê°’ì„ ë²„ë¦´ê²ƒì¸ì§€ ëŒ€ì²´í• ê²ƒì¸ì§€ 

ë²„ë¦¬ëŠ” ê³¼ì •ì—ì„œ ì¤‘ìš”í•œ ì˜ë¯¸ë¥¼ ê°–ê³ ìˆëŠ” ë°ì´í„°ê°€ ì†ì‹¤ë  ìˆ˜ ìˆìŒ

```
library(dplyr)
df<-select(df,Survived, Pclass, Age,Sex,SibSp,Parch)
```

select : dfì—ì„œ ì–´ë–¤ ì»¬ëŸ¼ì„ ì¶”ì¶œ?

â—ì›ë˜ ëº„ë•Œ ìƒê´€ë¶„ì„ì„ í•œ í›„ ì œê±°í•¨.



```
missmap(df, col=c("red","grey"))
```

<img src="8day.assets/image-20210303094342046.png" alt="image-20210303094342046" style="zoom:67%;" />



```
df<-na.omit(df)
missmap(df, col=c("red","grey"))
```

(ì¢‹ì€ ë°©ë²•ì€ ì•„ë‹˜!)

<img src="8day.assets/image-20210303094449255.png" alt="image-20210303094449255" style="zoom:67%;" />



```
df$Survived<-factor(df$Survived) #íŒ©í„°ë¡œ ë³¼ë•Œ í™œìš©ì´ í¸í•¨
df$Pclass<-factor(df$Pclass,order=TRUE,levels=c(3,2,1)) #ì„ ì‹¤ ë“±ê¸‰ì€ ìˆœì„œê°€ ìˆìœ¼ë¯€ë¡œ 
```



# ê³µë¶„ì‚°

í•œ ë³€ìˆ˜ì˜ ë³€í™”ê°€ ë‹¤ë¥¸ ë³€ìˆ˜ì˜ ë³€í™”ì— ì–¼ë§Œí¼ì˜ ì˜í–¥ì„ ì£¼ëŠ”ì§€

ex) í‚¤ê°€ í´ìˆ˜ë¡ ëª¸ë¬´ê²Œê°€ ë§ì´ ë‚˜ê°„ë‹¤

ìƒí™˜ê³„ìˆ˜ -1~1 ë²”ìœ„, 0ì— ê°€ê¹Œìš¸ìˆ˜ë¡ ë¬´ìƒê´€



```
install.packages("ggplot2")
library(ggplot2)                  
install.packages("GGally") #ì‚°ì ë„ ë“± ì‹œê°í™”
library(GGally)

ggcorr(df)
```

ì‚­ì œ ì•ˆí•œìƒíƒœë¡œ ë‹¤ì‹œ

```
df<-read.csv("train.csv", na.strings="") #ê²°ì¸¡ NA

ggcorr(df,nbreaks = 6, label=TRUE,label_size=3,color="grey50")
```

`ggcorr(nbreaks: ë‚˜ëˆ„ëŠ” êµ¬ê°„ ,label ë°•ìŠ¤ì•ˆì— ë“¤ì–´ê°€ëŠ” ê°’ )`  

<img src="8day.assets/image-20210303101118717.png" alt="image-20210303101118717" style="zoom:67%;" />



í•´ì„pclassê°€ ë‚®ì„ìˆ˜ë¡ survivedê°€ ì˜¬ë¼ê°

fareê°€ ë†’ì„ìˆ˜ë¡ survivedê°€ ì˜¬ë¼ê° 



# match

: ì²«ë²ˆì§¸ ì¸ìˆ˜ aê°€ ë‘ë²ˆì§¸ ì¸ìˆ˜ì˜ ëª‡ë²ˆì§¸ì— ìˆëŠ”ì§€ ì•Œë ¤ì¤€ë‹¤. ì—†ëŠ” ê²½ìš° NAê°€ ë°˜í™˜

```
a=c(1,2,3,4,5)
b=c(2,5,7,8,9)
> match(a,b)
[1] NA  1 NA NA  2
```

```
> match(a,b,nomatch = -1)
[1] -1  1 -1 -1  2
```

`nomatch =  ` : ë§¤ì¹˜ê°€ ì•ˆëœê²½ìš° ~ë¡œ í•˜ê² ë‹¤



```
car<-mtcars
car$name<-row.names(car) #nameì—´ ì¶”ê°€
```

row.names(car)ê°€ í•„ìš”í•˜ì§€ ì•ŠìŒ

```
row.names(car)<-NULL #ì‚­ì œ
head(car)
```



hp 145ë„˜ëŠ” ìë™ì°¨ëª¨ë¸ë¡œ dfêµ¬ì„±

```
highhp.car<-car[car$hp>145,]  
highhp.car

#ê°€ë²¼ìš´ ì°¨
lightwt.car<-car[car$wt<3.2,]
```

ë¬´ê²Œê°€ ê°€ë³ê³  í˜ì´ ìˆ ì°¨ (match)

```
#car[car$wt<3.2&car$hp>145,]

index<-match(highhp.car$name,lightwt.car$name)
 [1] NA NA NA NA NA NA NA NA NA NA NA NA 13 14 NA

lightwt.car[na.omit(index),]
```



match í•¨ìˆ˜ ëŒ€ì‹  `%in%` ì—°ì‚°ì ì‚¬ìš© ê°€ëŠ¥

```
> vec<-10:1
> 7 %in% vec
[1] TRUE

> c(20,15,11,9,8,3,1,0) %in% vec
[1] FALSE FALSE FALSE  TRUE  TRUE  TRUE  TRUE FALSE

#ë¬´ê²Œ ê°€ë³ê³  í˜ì´ ìˆ ì°¨
idx<-highhp.car$name %in% lightwt.car$name
highhp.car[idx,]

```



$ :ë°ì´í„°ë¡œë¶€í„° í•˜ë‚˜ì˜ ì›ì†Œë¥¼ ì¶”ì¶œ ë²¡í„°ë¡œ ë°˜í•œ

[[]] : í•˜ë‚˜ì˜ ì›ì†Œ ì¶”ì¶œ, ë¦¬ìŠ¤íŠ¸or df ëª¨ë‘ ì‚¬ìš©ê°€ëŠ¥ ì´ë¦„ê³¼ ìœ„ì¹˜ì— ì˜í•´ ì„ íƒ

[] : ë°ì´í„°ë¡œë¶€í„° ì—¬ëŸ¬ê°œì˜ ì›ì†Œë¥¼ ì¶”ì¶œ

```
mtcars$mpg
#head(mtcars)
#str(mtcars)
mtcars[[1]] #mpgì—´
mtcars[['mpg']]

mtcars[c(1,4)] #1ì—´,4ì—´ mpg,hp ë‚˜ì˜´
mtcars[c("mpg","hp")]
```



ìŒìˆ˜ ì¸ë±ìŠ¤ë¥¼ ì‚¬ìš©í•´ íŠ¹ì • ì›ì†Œ ì œì™¸ ì„œë¸Œì…‹ ìƒì„±

```
mtcars[-c(2,3,5,7:11)] #mpg,hp,wtë§Œ ì¶œë ¥ëœë‹¤
mtcars[-1] #mpgë§Œ ë¹¼ê³  ì¶œë ¥
```



íŠ¹ì • ì—´ ì œê±°

```
mtcars[1]<-NULL
mtcars
```



```
data(iris) #ìƒˆë¡­ê²Œ ì—´ì–´ì£¼ê¸° ê¸°ì¡´ê²Œ ë‚¨ì•„ìˆì–´ì„œ
str(iris)

#ë˜ ì—´ì¶”ì¶œ 
head(iris[1:4])
iris[,c("Sepal.Length", "Sepal.Width")]

iris[,"Sepal.Length"] #ë²¡í„°ì¶œë ¥
iris[,"Sepal.Length", drop=FALSE] #dfì¶œë ¥

iris["Sepal.Length"] #df
iris[,"Sepal.Length"] #í–‰ë ¬ ì»´ë§ˆì˜ ìœ ë¬´ ì°¨ì´
```

`drop=FALSE` ì˜µì…˜ìœ¼ë¡œ ë°ì´íŠ¸ í”„ë ˆì„ í˜•ì‹ ì¶”ì¶œ ê°€ëŠ¥



```
iris[1:5,]  # 1~5í–‰ ì¸ë±ìŠ¤ ë°ì´í„°ê°€ ì¶”ì¶œ
iris[1:5]  #1~5 ì—´ì´ ì¶”ì¶œ
```



ì¡°ê±´ ì¶”ì¶œ `subset`

```
subset(iris,select=c("Sepal.Length", "Sepal.Width"),
       subset=(Sepal.Length>7))
```

Sepal.Length>7ì¸ ì¡°ê±´ì„ ë§Œì¡±í•˜ëŠ” "Sepal.Length", "Sepal.Width"ì˜ ê°’



# ë°ì´í„° ë¬´ì‘ìœ„ í‘œë³¸ ì¶”ì¶œ

ë°ì´í„° -> ëª¨ë¸ë§ ->ì—ì¸¡/ ë¶„ë¥˜

ëª¨ë¸ë§ ê³¼ì •â”

1) ë°ì´í„°ë¥¼ í›ˆë ¨ìš©(70%)/ í…ŒìŠ¤íŠ¸ìš©(30%)ë¡œ ë¶„í• 

2) ì˜¤ì§ í›ˆë ¨ìš© ë°ì´í„°ë§Œìœ¼ë¡œ ëª¨ë¸(ì˜ˆì¸¡/ë¶„ë¥˜)ì„ ìƒì„±

í›ˆë ¨ ë°ì´í„°ë¡œ í‰ê°€ ê²°ê³¼>> í…ŒìŠ¤íŠ¸ ë°ì´í„° í‰ê°€



# í‘œë³¸ ì¶”ì¶œ sample í•¨ìˆ˜

`sample(ë°ì´í„°ì…‹, í‘œë³¸ ê°œìˆ˜, ë³µì›ì¶”ì¶œì—¬ë¶€)`

1~10 ì¤‘ì—ì„œ 5ê°œ ìˆ«ìë¥¼ ë¹„ë³µì› ì¶”ì¶œ (ì¤‘ë³µ x)

```
sample(1:10,5) #(default)replace =FALSE (ë¹„ë³µì›)
> sample(1:10,5)
[1] 2 6 1 3 4

> sample(1:10,5, replace=TRUE) #ë³µì› ì¤‘ë³µO
[1]  8 10  3  2 10 

sample(1:10) #10ê°œê°€ ëœë¤í•˜ê²Œ ë¹„ë³µì›
```



## seed

seed ê°’ì„ ë™ì¼í•˜ê²Œ ì£¼ë©´, ë§¤ë²ˆ ë°œìƒë˜ëŠ” ë‚œìˆ˜ê°€ ë™ì¼í•˜ê²Œ ì¶”ì¶œ

```
set.seed(20210303)
sample(1:10)
```

ì„ ìƒë‹˜ì´ë‘ ë˜‘ê°™ì´ ì¶œë ¥ë¨

ëª¨ë¸ì„ í‰ê°€í•˜ê¸° ìœ„í•´ì„œì„



```
#ë°ì´í„°í”„ë ˆì„ í–‰ìœ¼ë¡œë¶€í„° í‘œë³¸ ì¶”ì¶œ
set.seed(1)
#í–‰ ë²ˆí˜¸ ì¶”ì¶œ
sample(1:nrow(iris),5)
[1]  68 129  43  14  51
```



```
index<-sample(1:nrow(iris),5)
iris[index,] #ëœë¤ë²ˆí˜¸ì— í•´ë‹¹ë˜ëŠ” í–‰ ì¶œë ¥
```



ì¼ë°˜ì ìœ¼ë¡œ ì¤‘ë³µê°’ì€ ì œê±°

## duplicated()

 : ì¤‘ë³µ ì—¬ë¶€ë¥¼ ë…¼ë¦¬ê°’ìœ¼ë¡œ ì¶œë ¥

```
> duplicated(c(1,2,3,1,1,4,3))
[1] FALSE FALSE FALSE  TRUE  TRUE FALSE  TRUE
```



```
id<-c("a001","a002","a003")
name<-c("mouse","keyboard","usb")
price<-c(3000,9000,5000)
product<-data.frame(id=id, name=name,price=price)
product

#ì¤‘ë³µí–‰ ì¶”ê°€
product<-rbind(product, c("a001","mouse",3000))

duplicated(product) #í–‰ë‹¨ìœ„ë¡œ ì¶œë ¥ëœë‹¤
[1] FALSE FALSE FALSE  TRUE
```

â¬†â¬†â¬†â¬†ğŸ¦ââğŸ”¼â†Ÿâ†‘â†‘

```
> product
    id     name price
1 a001    mouse  3000
2 a002 keyboard  9000
3 a003      usb  5000

> rbind(product, c("a001","mouse",3000))
    id     name price
1 a001    mouse  3000
2 a002 keyboard  9000
3 a003      usb  5000
4 a001    mouse  3000
```



ì¤‘ë³µ ì œì™¸í•œ ë°ì´í„°ë§Œ ì¶”ì¶œ

```
> product[!duplicated(product),]
    id     name price
1 a001    mouse  3000
2 a002 keyboard  9000
3 a003      usb  5000
```



## which + duplicated 

: ì¤‘ë³µìœ„ì¹˜ë¥¼ íŒŒì•…

which : trueì— í•´ë‹¹ë˜ëŠ” ì¸ë±ìŠ¤ë¥¼ ì•Œë ¤ì¤Œ 

```
which(duplicated(product)) #4

#ì¤‘ë³µí–‰ ì œê±°
idx<-which(duplicated(product))
product.unique<-product[-idx,] #4í–‰ ì œê±°
product.unique
```



ì¤‘ë³µ ì›ì†Œ íŒŒì•…í•˜ì§€ ì•Šê³ , ì œê±°ë§Œ ìˆ˜í–‰ `unique()`

```
> product
    id     name price
1 a001    mouse  3000
2 a002 keyboard  9000
3 a003      usb  5000
4 a001    mouse  3000

> unique(product)
    id     name price
1 a001    mouse  3000
2 a002 keyboard  9000
3 a003      usb  5000
```



! , - ëŠ” ì˜ë¯¸ê°€ ë‹¤ë¦„

! (not) : ë…¼ë¦¬ê°’ì— ëŒ€í•´ ë°˜ì¡± (t->f->t)

`-` : íŠ¹ì • ì»¬ëŸ¼ì„ ëŒ€ìƒì—ì„œ ì œì™¸í• ë•Œ



# complete.cases í•¨ìˆ˜ 

ê²°ì¸¡ê°’ ì œê±°

```
complete.cases(airquality) #ê²°ì¸¡ê°’ ìˆìœ¼ë©´ false

#ê²°ì¸¡ê°’ì´ ì—†ëŠ” í–‰ë§Œ ì¶”ì¶œ
airquality[complete.cases(airquality),]

#ê²°ì¸¡ê°’ì´ ìˆëŠ” í–‰ë§Œ ì¶”ì¶œ
airquality[!complete.cases(airquality),]
```

ì•„ë‹ˆë©´ omitì¨ë„ ë¨

```
airquality.nona2<-(na.omit(airquality))
airquality.nona2
```



# cutí•¨ìˆ˜ 

: ë°ì´í„°ë¥¼ êµ¬ê°„ì— ë”°ë¼ ê·¸ë£¹ë³„ë¡œ ë²”ì£¼í™”

```
cut(x=iris$Sepal.Width, breaks = c(0,1,2,3,4,5))
#ì†Œê´„í˜¸ ê°œêµ¬ê°„ ì´ˆê³¼orë¯¸ë§Œ 
```

Levels: (0,1] (1,2] (2,3] (3,4] (4,5]

0<x<=1

```
cut(x=iris$Sepal.Width, breaks = c(0,1,2,3,4,5),right=FALSE)
#ì™¼ìª½ì´ íêµ¬ê°„, ì˜¤ë¥¸ìª½ì´ ê°œêµ¬ê°„ìœ¼ë¡œ ë°”ë€ë‹¤
```

Levels: [0,1) [1,2) [2,3) [3,4) [4,5)



* tableí•¨ìˆ˜, summary í•¨ìˆ˜ì™€ í•¨ê»˜ ì‚¬ìš©

```
iris.cut1<-cut(x=iris$Sepal.Width, breaks=c(0,1,2,3,4,5))
table(iris.cut1)
summary(iris.cut1)

iris.cut2<-cut(x=iris$Sepal.Width,
    breaks=c(0,1,2,3,4,5),
    labels=c("Smaller","Small","Medium","Big","Bigger"))

table(iris.cut2)
summary(iris.cut2)
```

ê²°ê³¼

```
iris.cut2
Smaller   Small  Medium     Big  Bigger 
      0       1      82      64       3 
> summary(iris.cut2)
Smaller   Small  Medium     Big  Bigger 
      0       1      82      64       3 
```

```
cut(x=iris$Sepal.Width, breaks= 5) #ìë™ìœ¼ë¡œ êµ¬ê°„

5 Levels: (2,2.48] (2.48,2.96] (2.96,3.44] ... (3.92,4.4]
```



`include.lowest=TRUE` ìµœì†Ÿê°’ì„ êµ¬ê°„ì— í¬í•¨ì‹œí‚¨ë‹¤. ì´ ì˜µì…˜ì€ ê³„ì† ì¨ì¤„ê²ƒ

```
iris.cut3<-cut(x=iris$Sepal.Width, 
               breaks= 5,        	labels=c("Smaller","Small","Medium","Big","Bigger"),
               include.lowest=TRUE)
iris.cut3
```

ì¶œë ¥

```
...

[148] Medium  Medium  Medium 
Levels: Smaller Small Medium Big Bigger
```



# sort()

ì •ë ¬

```
x<-c(3,7,5,1,2,5)
sort(x) #ì˜¤ë¦„ì°¨ìˆœ 
sort(x,decreasing = TRUE) #ë‚´ë¦¼ì°¨ìˆœ
```

# order()

ë°ì´í„° í”„ë ˆì„ ì •ë ¬ì‹œ ì‚¬ìš©

```
y<-c(11,22,33,55,44)
order(y)
y[order(y)]
```



```
y<-c(11,22,33,55,44)
z<-c("ss","bb","ii","aa","pp")
df<-data.frame(y,z)
df
```

```
#yì—´ ê¸°ì¤€ìœ¼ë¡œ ì˜¤ë¦„ì°¨ìˆœ ì •ë ¬
df[order(df$y),]

#yì—´ ê¸°ì¤€ìœ¼ë¡œ ë‚´ë¦¼ì°¨ìˆœ ì •ë ¬
df[order(df$y,decreasing=TRUE),]

w<-c("c","c","n","n","n")
df<-data.frame(y,z,w) #w ì—´ì¶”ê°€

#wì—´ 1ì°¨ ê¸°ì¤€, yì—´ 2ì°¨ ê¸°ì¤€
df[order(df$w, df$y),]
```



# xtfrm()

: ë™ì¼í•˜ì§€ ì•Šì€ ì •ë ¬ ë°©ë²•ì„ ì ìš©

```
> df$w
[1] "c" "c" "n" "n" "n"

> xtfrm(df$w) #ìˆ«ì ë²¡í„°
[1] 1 1 3 3 3
```

w ì—´ì„ ê¸°ì¤€ìœ¼ë¡œ ë‚´ë¦¼ì°¨ìˆœ, yì—´ì„ ê¸°ì¤€ìœ¼ë¡œ ì˜¤ë¦„ì°¨ìˆœ

```
> index<-order(-xtfrm(df$w), df$y)
> df[index,]
   y  z w
3 33 ii n
5 44 pp n
4 55 aa n
1 11 ss c
2 22 bb c
```



`-`: ë‚´ë¦¼ì°¨ìˆœ 

```
iris[order(-xtfrm(iris$Species), iris$Sepal.Length),]
```











